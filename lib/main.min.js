!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).LocalStorage={})}(this,function(t){"use strict";function e(t,e,s,i){if("a"===s&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===s?i:"a"===s?i.call(t):i?i.value:e.get(t)}function s(t,e,s,i,r){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?r.call(t,s):r?r.value=s:e.set(t,s),s}var i,r,n,a,o,h,l,c,u,f,d,g,p,y,w,v,m,k,x,E,W,M;"function"==typeof SuppressedError&&SuppressedError;class b{constructor(){i.set(this,0),r.set(this,5242880),s(this,i,this.space(),"f")}get length(){return Object.keys(this).length}getItem(t){return this[t]||null}setItem(t,e){const r=String(e);this.exceeded(t,r)&&this.throw(t),this[t]=r,s(this,i,this.space(),"f")}removeItem(t){delete this[t],s(this,i,this.space(),"f")}clear(){for(const t of Object.keys(this))delete this[t];s(this,i,this.space(),"f")}key(t){var e;return null!==(e=Object.keys(this)[t])&&void 0!==e?e:null}space(){s(this,i,0,"f");for(const t of Object.keys(this))s(this,i,e(this,i,"f")+this.size(t,this[t]),"f");return e(this,i,"f")}size(t,e){return new Blob([t,e]).size}exceeded(t,s){return this.size(t,s)+e(this,i,"f")>e(this,r,"f")}throw(t){throw new DOMException(`Failed to execute 'setItem' on 'Storage': Setting the value of '${t}' exceeded the quota.`,"QuotaExceededError")}}i=new WeakMap,r=new WeakMap;class F extends Event{constructor(){super("local-storage:flushing"),n.set(this,void 0)}get key(){return e(this,n,"f")}}n=new WeakMap;class S extends Event{constructor(){super("local-storage:flushed"),a.set(this,void 0)}get key(){return e(this,a,"f")}}a=new WeakMap;class O extends Event{constructor(t){super("local-storage:retrieving"),o.set(this,void 0),s(this,o,t,"f")}get key(){return e(this,o,"f")}}o=new WeakMap;class j extends Event{constructor(t,e){super("local-storage:hit"),h.set(this,void 0),l.set(this,void 0),s(this,h,t,"f"),s(this,l,e,"f")}get key(){return e(this,h,"f")}get value(){return e(this,l,"f")}}h=new WeakMap,l=new WeakMap;class I extends Event{constructor(t){super("local-storage:missed"),c.set(this,void 0),s(this,c,t,"f")}get key(){return e(this,c,"f")}}c=new WeakMap;class K extends Event{constructor(t,e,i=null){super("local-storage:write-failed"),u.set(this,void 0),f.set(this,void 0),d.set(this,void 0),s(this,u,t,"f"),s(this,f,e,"f"),s(this,d,i,"f")}get key(){return e(this,u,"f")}get value(){return e(this,f,"f")}get expiry(){return e(this,d,"f")}}u=new WeakMap,f=new WeakMap,d=new WeakMap;class T extends Event{constructor(t,e,i=null){super("local-storage:written"),g.set(this,void 0),p.set(this,void 0),y.set(this,void 0),s(this,g,t,"f"),s(this,p,e,"f"),s(this,y,i,"f")}get key(){return e(this,g,"f")}get value(){return e(this,p,"f")}get expiry(){return e(this,y,"f")}}g=new WeakMap,p=new WeakMap,y=new WeakMap;class z extends Event{constructor(t,e,i=null){super("local-storage:writing"),w.set(this,void 0),v.set(this,void 0),m.set(this,void 0),s(this,w,t,"f"),s(this,v,e,"f"),s(this,m,i,"f")}get key(){return e(this,w,"f")}get value(){return e(this,v,"f")}get expiry(){return e(this,m,"f")}}w=new WeakMap,v=new WeakMap,m=new WeakMap;class D extends Event{constructor(t){super("local-storage:forgot"),k.set(this,void 0),s(this,k,t,"f")}get key(){return e(this,k,"f")}}k=new WeakMap;class L extends Event{constructor(t){super("local-storage:forgot-failed"),x.set(this,void 0),s(this,x,t,"f")}get key(){return e(this,x,"f")}}x=new WeakMap;class N{static ttl(t){s(this,E,t,"f",M)}static set(t,s,i=null){i=null!=i?i:e(this,E,"f",M);const r={data:"function"==typeof s?s():s,expiry:i?Date.now()+1e3*i:null};this.emit(new z(t,r.data,r.expiry));try{e(this,E,"f",W).setItem(t,JSON.stringify(r)),this.emit(new T(t,r.data,r.expiry))}catch(e){return this.emit(new K(t,r.data,r.expiry)),!1}return!0}static get(t,s=null){var i;this.emit(new O(t));const r=e(this,E,"f",W).getItem(t);if(null===r)return this.emit(new I(t)),"function"==typeof s?s():s;let n;try{const e=JSON.parse(r);if(e.expiry&&Date.now()>e.expiry)return this.remove(t),null;n=null!==(i=e.data)&&void 0!==i?i:e}catch(t){n=r}return this.emit(new j(t,n)),n}static remember(t,s,i=null){const r=this.get(t);return null===r&&this.set(t,s,null!=i?i:e(this,E,"f",M)),null!=r?r:this.get(t)}static all(){return this.keys().map(t=>({key:t,value:this.get(t)}))}static remove(t){return this.has(t)?(e(this,E,"f",W).removeItem(t),this.emit(new D(t)),!0):(this.emit(new L(t)),!1)}static clear(){this.emit(new F),e(this,E,"f",W).clear(),this.emit(new S)}static has(t){return!!this.get(t)}static missing(t){return!this.has(t)}static hasAny(...t){return 1===t.length&&(t=Array.isArray(t[0])?t[0]:[t[0]]),t.some(t=>this.has(t))}static isEmpty(){return 0===e(this,E,"f",W).length}static isNotEmpty(){return!this.isEmpty()}static keys(){return Object.keys(e(this,E,"f",W))}static count(){return e(this,E,"f",W).length}static touch(t,s=null){const i=this.get(t);return null!==i&&this.set(t,i,null!=s?s:e(this,E,"f",M))}static expiry(t){const s=e(this,E,"f",W).getItem(t);if(null===s)return null;try{const t=JSON.parse(s);return null===t||void 0===t.expiry||null===t.expiry?null:new Date(t.expiry)}catch(t){return null}}static dump(t){console.log(this.get(t))}static fake(){s(this,E,new b,"f",W)}static restore(){s(this,E,localStorage,"f",W)}static isFake(){return e(this,E,"f",W)instanceof b}static listen(t,e=null){t="string"==typeof t?{[t]:e}:t;for(const[e,s]of Object.entries(t))addEventListener(`local-storage:${e}`,s,{once:!0})}static onRetrieving(t){this.listen("retrieving",t)}static onHit(t){this.listen("hit",t)}static onMissed(t){this.listen("missed",t)}static onWriting(t){this.listen("writing",t)}static onWritten(t){this.listen("written",t)}static onWriteFailed(t){this.listen("write-failed",t)}static onForgot(t){this.listen("forgot",t)}static onForgotFailed(t){this.listen("forgot-failed",t)}static onFlushing(t){this.listen("flushing",t)}static onFlushed(t){this.listen("flushed",t)}static emit(t){dispatchEvent(t)}}E=N,W={value:localStorage},M={value:null},t.KeyForgotFailed=L,t.KeyForgotten=D,t.KeyHit=j,t.KeyMissed=I,t.KeyWriteFailed=K,t.KeyWritten=T,t.LocalStorage=N,t.LocalStorageFake=b,t.RetrievingKey=O,t.StorageFlushed=S,t.StorageFlushing=F,t.WritingKey=z});
//# sourceMappingURL=main.min.js.map
